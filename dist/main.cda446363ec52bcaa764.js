!function(e){function t(t){for(var r,o,c=t[0],i=t[1],l=t[2],p=0,m=[];p<c.length;p++)o=c[p],Object.prototype.hasOwnProperty.call(s,o)&&s[o]&&m.push(s[o][0]),s[o]=0;for(r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r]);for(u&&u(t);m.length;)m.shift()();return a.push.apply(a,l||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],r=!0,c=1;c<n.length;c++){var i=n[c];0!==s[i]&&(r=!1)}r&&(a.splice(t--,1),e=o(o.s=n[0]))}return e}var r={},s={0:0},a=[];function o(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=r,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(n,r,function(t){return e[t]}.bind(null,r));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="./";var c=this.webpackJsonp=this.webpackJsonp||[],i=c.push.bind(c);c.push=t,c=c.slice();for(var l=0;l<c.length;l++)t(c[l]);var u=i;a.push([621,1]),n()}({1031:function(e,t){},1033:function(e,t){},1134:function(e,t){},1169:function(e,t){},1196:function(e,t){},1373:function(e,t){},1469:function(e,t){},1483:function(e,t){},1510:function(e,t){},1512:function(e,t){},1535:function(e,t){},1536:function(e,t){},1571:function(e,t){},284:function(e,t){},490:function(e,t){},621:function(e,t,n){n(622),e.exports=n(808)},808:function(e,t,n){"use strict";n.r(t),function(e){var t,r=n(616),s=n.n(r),a=n(617),o=n.n(a),c=n(619),i=n(620),l=n(618),u=n.n(l);n(584),n(1644);function p(e,t,n,r,s,a,o){try{var c=e[a](o),i=c.value}catch(e){return void n(e)}c.done?t(i):Promise.resolve(i).then(r,s)}function m(e){return function(){var t=this,n=arguments;return new Promise((function(r,s){var a=e.apply(t,n);function o(e){p(a,r,s,o,c,"next",e)}function c(e){p(a,r,s,o,c,"throw",e)}o(void 0)}))}}(t="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0)&&t(e);"undefined"!=typeof reactHotLoaderGlobal&&reactHotLoaderGlobal.default.signature;window.MediaRecorder=i.a;var y,g,d,k,h=document.getElementById("connect"),f=document.getElementById("message"),v=document.getElementById("send"),j=document.getElementById("send2"),b=document.getElementById("channel"),A=document.getElementById("messages"),D=document.getElementById("username"),w=document.getElementById("user"),x=document.getElementById("peersCount"),E=document.getElementById("play"),I=document.getElementById("stop"),C=document.getElementById("castcontrol"),B=document.getElementById("stopRecord"),S=document.getElementById("player"),L=document.getElementById("playwav"),M=document.getElementById("playwavstop"),R=document.getElementById("joinchannel"),T=0,O=!1,_=new u.a,N="",P=0,H=0,G=0,J=!1,U=1,W="",F="",q="",X={},z=0,K="",Q=20,V="Anonymous"+(new Date).getTime().toString().slice(-4);document.getElementById("userId").innerHTML=V;var Y="",Z={EXPERIMENTAL:{pubsub:!0,sharding:!1,dht:!1},preload:{enabled:!1},config:{Addresses:{Swarm:["/dns4/glacial-bastion-28924.herokuapp.com/tcp/443/wss/p2p-webrtc-star"]}}},$=new c.a("https://siasky.net"),ee=function(e,t){t.loaded,t.total;console.info("Progress ".concat(Math.round(100*e),"%"))},te={dbOptions:{maxHistory:Q}},ne=[];function re(e){w.value=e,D.innerHTML=e,N=e,Z.repo="/orbit/browser-example/".concat(e);var t=new s.a(Z);t.on("ready",(function(){return ae(t,e)}))}function se(e){return console.log("sleeping ",e/1e3),new Promise((function(t){return setTimeout(t,e)}))}function ae(e,t){te.dbOptions.directory="/orbit/browser-example/".concat(t);var n=new o.a(e,te);y=n,n.events.on("connected",(function(){return n.join(Y)})),n.events.on("joined",ie),n.events.on("replicate.progress",(function(e,t,n,r,s){console.log("replicating",e,t,n,r,s)})),n.events.on("write",(function(e,t,n){console.log("writing",e,t,n)})),n.events.on("closed",(function(e){console.log("closing")})),n.connect(t),(h=fe(h)).addEventListener("click",m(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.disconnect();case 2:return t.next=4,e.stop();case 4:re(w.value);case 5:case"end":return t.stop()}}),t)})))),n.events.on("entry",(function(e,t){e.payload.value}))}function oe(e){return J=!0,fetch(e.next).then((function(e){return e.text()})).then((function(e){var t=JSON.parse(e);fetch(t.link).then((function(e){return e.arrayBuffer()})).then((function(e){_._backend._context.decodeAudioData(e,(function(e){a_buffer=[e.getChannelData(0)],_.bufferData(a_buffer),"none"!==t.next?oe(t):J=!1})),console.log(e)}))}))}function ce(e){var t;return fetch(e.link).then((function(e){return e.arrayBuffer()})).then((function(e){_._backend._context.decodeAudioData(e,(function(e){t=[e.getChannelData(0)],_.bufferData(t)})),console.log(e)}))}function ie(e,t){ne=[],"skayak-user"===e.substring(0,11)?(d=t,console.log("user channel joined",e)):g=t,f=fe(f),v=fe(v),j=fe(j),L=fe(L),C=fe(C),b.innerHTML="#"+e,t.on("ready",m(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.peers.then(he);case 1:case"end":return e.stop()}}),e)})))),t.on("entry",(function(e){var n;ke(ne=[].concat(ne,[e.payload.value]).sort((function(e,t){return e.meta.ts-t.meta.ts}))),t.peers.then(he),console.log("channel entry",G++);try{var r=JSON.parse(e.payload.value.content);if("none"===r.link&&""!==r.newChannelName&&e.payload.value.meta.from.name!==N){X[r.newChannelName]=r.ChannelStatus,n=document.getElementById("castlookup").remove();var s=document.getElementById("channelList").querySelectorAll("#"+r.newChannelTitle);if(r.ChannelStatus&&0==s.length){var a=document.createElement("div");a.setAttribute("id",r.newChannelTitle);var o=document.createElement("span");o.appendChild(document.createTextNode(r.newChannelTitle+" "));var c=document.createElement("span");c.setAttribute("class","glyphicon-basic glyphicon glyphicon-play"),c.setAttribute("data-attribute","play"),a.appendChild(o),a.appendChild(c),c.addEventListener("click",m(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("stop"!=c.getAttribute("data-attribute")){e.next=9;break}c.setAttribute("class","glyphicon-basic glyphicon glyphicon-play"),c.setAttribute("data-attribute","play"),q="",M.click(),y.join(W),console.log("joining general channel"),e.next=20;break;case 9:if(""!=q||"play"!=c.getAttribute("data-attribute")){e.next=20;break}return we(),e.next=13,fetch("https://time.akamai.com").then((function(e){return e.text()}));case 13:t=e.sent,n=parseInt(t/50),q="skayak-user-"+r.newChannelTitle+"-"+n.toString(),K=r.newChannelTitle,c.setAttribute("class","glyphicon-basic glyphicon glyphicon-stop"),c.setAttribute("data-attribute","stop"),y.join(q);case 20:case"end":return e.stop()}}),e)})))),document.getElementById("channelList").appendChild(a)}r.ChannelStatus||(document.getElementById(r.newChannelTitle).remove(),0==document.getElementById("channelList").childNodes.length&&document.getElementById("skayak-cont").appendChild(n),""!=q&&(M.click(),y.leave(q),fetch("https://time.akamai.com").then((function(e){return e.text()})).then((function(e){var t=parseInt(e/50);W="skayak-general-"+t.toString(),y.join(W),q=""}))))}e.payload.value.meta.from.name!==N&&r.ts>P&&"none"!==r.link&&(P=r.ts,console.log("TT link ",e.payload.value.meta.from.name,r.ts),ce(r),z=0)}catch(e){console.log(e)}})),v.addEventListener("click",(function(){return le()})),R.addEventListener("click",(function(){y.join(W)})),f.addEventListener("keyup",(function(e){13===e.keyCode&&le()})),L.addEventListener("click",m(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",we());case 1:case"end":return e.stop()}}),e)})))),C.addEventListener("click",(function(){"cast"==C.getAttribute("data-attribute")?(C.setAttribute("data-attribute","stop"),document.getElementById("casticon").setAttribute("class","fa fa-stop-circle"),xe()):(C.setAttribute("data-attribute","cast"),document.getElementById("casticon").setAttribute("class","fa fa-microphone"),B.click())})),t.load(10),U=0}function le(){g.sendMessage(f.value),f.value=null}function ue(e){}function pe(e,t){return e.lastModifiedDate=new Date,e.name=t,e}function me(e){return ye.apply(this,arguments)}function ye(){return(ye=m(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,$.upload(t,{onUploadProgress:ee});case 3:return n=e.sent,r=n.skylink,e.abrupt("return",r);case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))).apply(this,arguments)}function ge(e){T=setInterval(m(regeneratorRuntime.mark((function e(){var t,n,r,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Math.random().toString(36).substring(7),n=new Blob([t],{type:"text/html"}),r=pe(n,"my-text.html"),e.prev=4,e.next=7,me(r);case 7:s=e.sent,{link:"https://siasky.net/"+s},console.log("joined channel!!"),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(4),console.log("error skylkiknking");case 16:case"end":return e.stop()}}),e,null,[[4,13]])}))),1e4)}function de(e){console.log("stopping data"),clearInterval(T)}function ke(e){A.innerHTML=e.slice(-Q).map((function(e){return"".concat(ve(e.meta.ts)," &lt;").concat(e.meta.from.name,"&gt; ").concat(e.content,"<br/>")})).join("\n")}function he(e){x.innerHTML="Peers: "+(e?e.length:0)}function fe(e){var t=e.cloneNode(!0);return e.parentNode.replaceChild(t,e),t}function ve(e){var t=function(e){return("0"+e).slice(-2)},n=new Date(e);return t(n.getHours())+":"+t(n.getMinutes())+":"+t(n.getSeconds())}function je(e){navigator.mediaDevices.getUserMedia({audio:!0}).then((function(e){O=!1;(k=new MediaRecorder(e)).start(),console.log("record start"),k.addEventListener("dataavailable",function(){var e=m(regeneratorRuntime.mark((function e(t){var n,r,s,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return S.src=URL.createObjectURL(t.data),n=pe(t.data,"1.wav"),e.prev=2,e.next=5,me(n);case 5:return r=e.sent,s="https://siasky.net/"+r,a={},console.log(s),e.next=11,fetch("https://time.akamai.com").then((function(e){return e.text()}));case 11:H=e.sent,a={link:s,ts:parseInt(H)},d.sendMessage(JSON.stringify(a)),e.next=19;break;case 16:e.prev=16,e.t0=e.catch(2),console.log("error skylkiknking");case 19:case"end":return e.stop()}}),e,null,[[2,16]])})));return function(t){return e.apply(this,arguments)}}())}))}function be(){return Ae.apply(this,arguments)}function Ae(){return(Ae=m(regeneratorRuntime.mark((function e(){var t,n,r,s,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://time.akamai.com").then((function(e){return e.text()}));case 2:return t=e.sent,n=parseInt(parseInt(t)/100),W="skayak-general-"+n.toString(),console.log(W),Y=W,re(V),e.next=10,fetch("https://time.akamai.com").then((function(e){return e.text()}));case 10:t=e.sent,n=parseInt(parseInt(t)/100),r=1e3*(100-parseInt(t)%100);case 13:return e.next=16,se(r);case 16:return""!=q?y.leave(q):""!=F?y.leave(F):y.leave(W),console.log("leaving",W),e.next=20,fetch("https://time.akamai.com").then((function(e){return e.text()}));case 20:t=e.sent,n=parseInt(t/100),""!=q?(s=parseInt(t/50),q="skayak-user-"+q.substring(12,25)+"-"+s.toString(),W="skayak-general-"+n.toString(),console.log("joining",q),r=1e3*(50-parseInt(s)%50),y.join(q)):""!=F?(a=parseInt(t/50),F="skayak-user-"+F.substring(12,25)+"-"+a.toString(),W="skayak-general-"+n.toString(),console.log("joining",F),r=1e3*(50-parseInt(a)%50),y.join(F)):(W="skayak-general-"+n.toString(),console.log("joining",W),y.join(W),r=1e5),e.next=13;break;case 25:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function De(e){var t=Math.round(48e3*e),n=261*Math.ceil(t/261),r=[new Float32Array(n)];_.bufferData(r)}function we(){console.log("playwav start"),_.init(1,44100),De(1),_.start()}function xe(){return Ee.apply(this,arguments)}function Ee(){return(Ee=m(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return O=!1,e.next=3,fetch("https://time.akamai.com").then((function(e){return e.text()}));case 3:t=e.sent,n=parseInt(t/100),F="skayak-user-"+V+"-"+n.toString(),y.join(F),g.sendMessage(JSON.stringify({link:"none",newChannelName:F,newChannelTitle:V,ChannelStatus:!0}));case 8:if(O){e.next=16;break}return k&&(k.stop(),k.stream.getTracks().forEach((function(e){return e.stop()}))),console.log("start record time "),je(),e.next=14,se(1e4);case 14:e.next=8;break;case 16:case"end":return e.stop()}}),e)})))).apply(this,arguments)}B.addEventListener("click",m(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return k.stop(),console.log("record stop"),O=!0,d.sendMessage(JSON.stringify({link:"none",newChannelName:F,newChannelTitle:V,ChannelStatus:!1})),e.next=6,fetch("https://time.akamai.com").then((function(e){return e.text()}));case 6:t=e.sent,n=parseInt(t/100),W="skayak-general-"+n.toString(),y.leave(F),y.join(W),console.log("joining back",W),g.sendMessage(JSON.stringify({link:"none",newChannelName:F,newChannelTitle:V,ChannelStatus:!1})),F="",k.stream.getTracks().forEach((function(e){return e.stop()}));case 15:case"end":return e.stop()}}),e)})))),be();var Ie,Ce;_.onstarved=function(){console.log("starving"),De(1)},_.onbufferlow=function(){console.log("buffer low"),De(2),++z>10&&(document.getElementById(K)&&document.getElementById(K).remove(),q="",M.click(),y.join(W),console.log("joining general channel"))},M.addEventListener("click",(function(){console.log(_._backend),_.stop(),console.log("stopping feeder")})),(Ie="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0)&&(Ie.register(h,"connectButton","/home/cyril/Documents/skayak/src/App.js"),Ie.register(f,"messageField","/home/cyril/Documents/skayak/src/App.js"),Ie.register(v,"sendButton","/home/cyril/Documents/skayak/src/App.js"),Ie.register(j,"sendGreetingButton","/home/cyril/Documents/skayak/src/App.js"),Ie.register(b,"channelNameElement","/home/cyril/Documents/skayak/src/App.js"),Ie.register(A,"messagesElement","/home/cyril/Documents/skayak/src/App.js"),Ie.register(D,"usernameElement","/home/cyril/Documents/skayak/src/App.js"),Ie.register(w,"userField","/home/cyril/Documents/skayak/src/App.js"),Ie.register(x,"peersElm","/home/cyril/Documents/skayak/src/App.js"),Ie.register(E,"playDataElm","/home/cyril/Documents/skayak/src/App.js"),Ie.register(I,"stopDataElm","/home/cyril/Documents/skayak/src/App.js"),Ie.register(C,"recordButton","/home/cyril/Documents/skayak/src/App.js"),Ie.register(B,"stopButton","/home/cyril/Documents/skayak/src/App.js"),Ie.register(S,"audioElement","/home/cyril/Documents/skayak/src/App.js"),Ie.register(L,"playWavElm","/home/cyril/Documents/skayak/src/App.js"),Ie.register(M,"playWavStopElm","/home/cyril/Documents/skayak/src/App.js"),Ie.register(R,"joinChannelElm","/home/cyril/Documents/skayak/src/App.js"),Ie.register("","full_string","/home/cyril/Documents/skayak/src/App.js"),Ie.register(T,"interv","/home/cyril/Documents/skayak/src/App.js"),Ie.register(O,"isStopRecording","/home/cyril/Documents/skayak/src/App.js"),Ie.register(void 0,"streamer","/home/cyril/Documents/skayak/src/App.js"),Ie.register(_,"feeder","/home/cyril/Documents/skayak/src/App.js"),Ie.register(N,"myName","/home/cyril/Documents/skayak/src/App.js"),Ie.register(P,"latest","/home/cyril/Documents/skayak/src/App.js"),Ie.register(H,"sync_timestamp","/home/cyril/Documents/skayak/src/App.js"),Ie.register("","current_link","/home/cyril/Documents/skayak/src/App.js"),Ie.register("","next_link","/home/cyril/Documents/skayak/src/App.js"),Ie.register(!0,"first_chunk_message","/home/cyril/Documents/skayak/src/App.js"),Ie.register(G,"channel_message_counter","/home/cyril/Documents/skayak/src/App.js"),Ie.register(y,"orbity","/home/cyril/Documents/skayak/src/App.js"),Ie.register(J,"redeemingData","/home/cyril/Documents/skayak/src/App.js"),Ie.register(U,"first_run","/home/cyril/Documents/skayak/src/App.js"),Ie.register(W,"latestChannel","/home/cyril/Documents/skayak/src/App.js"),Ie.register(g,"latestChannelObject","/home/cyril/Documents/skayak/src/App.js"),Ie.register(d,"castChannelObject","/home/cyril/Documents/skayak/src/App.js"),Ie.register(F,"castChannelName","/home/cyril/Documents/skayak/src/App.js"),Ie.register(void 0,"listenChannel","/home/cyril/Documents/skayak/src/App.js"),Ie.register(q,"listenChannelName","/home/cyril/Documents/skayak/src/App.js"),Ie.register(X,"CastingChannelTable","/home/cyril/Documents/skayak/src/App.js"),Ie.register(z,"buffer_threshold","/home/cyril/Documents/skayak/src/App.js"),Ie.register(K,"listeningToUser","/home/cyril/Documents/skayak/src/App.js"),Ie.register(Q,"visibleMessages","/home/cyril/Documents/skayak/src/App.js"),Ie.register(k,"recorder","/home/cyril/Documents/skayak/src/App.js"),Ie.register(V,"username","/home/cyril/Documents/skayak/src/App.js"),Ie.register(Y,"channelName","/home/cyril/Documents/skayak/src/App.js"),Ie.register(Z,"ipfsOptions","/home/cyril/Documents/skayak/src/App.js"),Ie.register($,"client","/home/cyril/Documents/skayak/src/App.js"),Ie.register(ee,"onUploadProgress","/home/cyril/Documents/skayak/src/App.js"),Ie.register(te,"orbitOptions","/home/cyril/Documents/skayak/src/App.js"),Ie.register(ne,"messages","/home/cyril/Documents/skayak/src/App.js"),Ie.register(re,"startIpfs","/home/cyril/Documents/skayak/src/App.js"),Ie.register(se,"sleepp","/home/cyril/Documents/skayak/src/App.js"),Ie.register(ae,"initOrbit","/home/cyril/Documents/skayak/src/App.js"),Ie.register(oe,"getWavData","/home/cyril/Documents/skayak/src/App.js"),Ie.register(ce,"getWavFile","/home/cyril/Documents/skayak/src/App.js"),Ie.register(ie,"onJoinedChannel","/home/cyril/Documents/skayak/src/App.js"),Ie.register(le,"sendMessage","/home/cyril/Documents/skayak/src/App.js"),Ie.register(ue,"sendGreeting","/home/cyril/Documents/skayak/src/App.js"),Ie.register(pe,"blobToFile","/home/cyril/Documents/skayak/src/App.js"),Ie.register(me,"uploadExample","/home/cyril/Documents/skayak/src/App.js"),Ie.register(ge,"sendData","/home/cyril/Documents/skayak/src/App.js"),Ie.register(de,"stopData","/home/cyril/Documents/skayak/src/App.js"),Ie.register(ke,"renderMessages","/home/cyril/Documents/skayak/src/App.js"),Ie.register(he,"renderPeers","/home/cyril/Documents/skayak/src/App.js"),Ie.register(fe,"replaceElement","/home/cyril/Documents/skayak/src/App.js"),Ie.register(ve,"formatTimestamp","/home/cyril/Documents/skayak/src/App.js"),Ie.register(je,"startRecording","/home/cyril/Documents/skayak/src/App.js"),Ie.register(be,"startup","/home/cyril/Documents/skayak/src/App.js"),Ie.register(De,"bufferSineWave","/home/cyril/Documents/skayak/src/App.js"),Ie.register(void 0,"daty","/home/cyril/Documents/skayak/src/App.js"),Ie.register(we,"playWav","/home/cyril/Documents/skayak/src/App.js"),Ie.register(xe,"startStream","/home/cyril/Documents/skayak/src/App.js"),Ie.register(0,"sampleCounter","/home/cyril/Documents/skayak/src/App.js")),(Ce="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0)&&Ce(e)}.call(this,n(809)(e))},921:function(e,t){},931:function(e,t){},942:function(e,t){},944:function(e,t){}});